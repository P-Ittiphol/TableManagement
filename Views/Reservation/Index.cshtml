@model TableManagement.ViewModels.ReservationViewModel

@{
    ViewData["Title"] = "Reservation";
    ViewData["PageHeader"] = "‡∏à‡∏≠‡∏á‡πÇ‡∏ï‡πä‡∏∞‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£";
}

<div class="row">

    <!-- üîµ ‡∏ù‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≤‡∏¢ ‡πÅ‡∏™‡∏î‡∏á‡πÇ‡∏ï‡πä‡∏∞ -->
    <div class="col-md-7">
        <h4>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏ï‡πä‡∏∞</h4>

        @foreach (var zoneGroup in Model.Tables.GroupBy(t => t.Zone))
        {
            <h5 class="mt-3">‡πÇ‡∏ã‡∏ô @zoneGroup.Key</h5>

            <div class="row">
                @foreach (var table in zoneGroup)
                {
                    <div class="col-md-3 mb-2">
                        <div class="card text-center p-2
                            @(table.Status == "‡∏ß‡πà‡∏≤‡∏á" ? "bg-success text-white" : "bg-danger text-white")">

                            <strong>@table.TableCode</strong>

                            @if (table.Status == "‡∏ß‡πà‡∏≤‡∏á")
                            {
                                <button class="btn btn-light btn-sm mt-2"
                                        onclick="selectTable(@table.Id, '@table.TableCode')">
                                    ‡∏à‡∏≠‡∏á‡πÇ‡∏ï‡πä‡∏∞
                                </button>
                            }
                        </div>
                    </div>
                }
            </div>
        }
    </div>


    <!-- üî¥ ‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏ß‡∏≤ ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏à‡∏≠‡∏á -->
    <div class="col-md-5">
        <div id="reservationForm" style="display:none;">
            <h4>‡∏à‡∏≠‡∏á‡πÇ‡∏ï‡πä‡∏∞ <span id="selectedTableCode"></span></h4>

            <form asp-action="Create" method="post">
                
                <input type="hidden" asp-for="Reservation.TableId" id="selectedTableId" />
                <input type="hidden" asp-for="Reservation.ReservationDate" />

                <div class="form-group">
                    <label>‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</label>
                    <input asp-for="Reservation.CustomerName" class="form-control" />
                    <span asp-validation-for="Reservation.CustomerName" class="text-danger"></span>
                </div>

                <div class="form-group">
                    <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</label>
                    <input asp-for="Reservation.PhoneNumber" class="form-control" />
                    <span asp-validation-for="Reservation.PhoneNumber" class="text-danger"></span>
                </div>

                <button type="submit" class="btn btn-success mt-2">
                    ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á
                </button>
            </form>
        </div>
    </div>

</div>

</div>

<script>
    function selectTable(id, code) {
        document.getElementById("TableId").value = id;
        document.getElementById("SelectedTable").value = code;
    }

     function selectTable(tableId, tableCode) {
        document.getElementById("selectedTableId").value = tableId;
        document.getElementById("selectedTableCode").innerText = tableCode;
        document.getElementById("reservationForm").style.display = "block";
    }


</script>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>
        $(document).ready(function () {

            // Validate ‡πÅ‡∏ö‡∏ö realtime ‡∏ï‡∏≠‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå
            $("input").on("keyup", function () {
                $(this).valid();
            });

        });
    </script>

    @if (TempData["Success"] != null)
    {
        <script>
            Swal.fire({
                title: '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                text: '@Html.Raw(TempData["Success"])',
                icon: 'success',
                confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á'
            });
        </script>
    }
}

